
<div>

<span>

<span>

<p>
配点 : $600$点
</p>

<div>

<section>

### **問題文**

<p>
正整数からなる数列 $X = (X_1, \dots, X_n)$に対し、その連長圧縮の任意の (長さ・値) ペアにおいて長さと値が等しいとき、かつそのときに限り、$X$を 
<strong>
221 数列
</strong>
と呼びます。より厳密には、以下の条件を満たす数列を 221 数列であるとします。
</p>

<ul>

<li>
$1 \leq l \leq r \leq n$を満たす整数組 $(l, r)$が以下の $3$つの条件をすべて満たすならば、必ず $(r-l+1) = X_l$が成り立つ。
<ul>

<li>
$l = 1$または ($l \geq 2$かつ $X_{l-1} \neq X_l$)
</li>

<li>
$r = n$または ($r \leq n-1$かつ $X_{r+1} \neq X_r$)
</li>

<li>
$X_l = X_{l+1} = \dots = X_r$
</li>

</ul>

</li>

</ul>

<p>
たとえば、$(2,2,3,3,3,1,2,2)$は 221 数列ですが、$(1,1)$や $(4,4,1,4,4)$は 221 数列ではありません。
</p>

<p>
長さ $N$の正整数列 $A = (A_1, \dots, A_N)$が与えられます。$A$の空でない(連続とは限らない)部分列であって、221 数列であるものの個数を $998244353$で割ったあまりを求めてください。
ただし、異なる位置から取り出した部分列であっても、数列として一致するものは区別せずまとめて $1$通りとして数えます。
</p>

</section>

</div>

<div>

<section>

### **制約**

<ul>

<li>
$1 \leq N \leq 500\,000$
</li>

<li>
$1 \leq A_i \leq N$
</li>

<li>
入力される値はすべて整数
</li>

</ul>

</section>

</div>

---

<div>

<div>

<section>

### **入力**

<p>
入力は以下の形式で標準入力から与えられる。
</p>

<div>

$N$$A_1$$A_2$$\cdots$$A_N$
</div>

</section>

</div>

<div>

<section>

### **出力**

<p>
答えを $1$行に出力せよ。
</p>

</section>

</div>

</div>

---

<div>

<section>

### **入力例 1**

<div>

8
2 1 2 1 1 2 7 2

</div>

</section>

</div>

<div>

<section>

### **出力例 1**

<div>

5

</div>

<p>
$A$の空でない部分列として現れる 221 数列は以下の $5$通りです。
</p>

<ul>

<li>
$(1)$
</li>

<li>
$(1,2,2)$
</li>

<li>
$(2,2)$
</li>

<li>
$(2,2,1)$
</li>

<li>
$(2,2,1,2,2)$
</li>

</ul>

</section>

</div>

---

<div>

<section>

### **入力例 2**

<div>

5
2 3 4 5 4

</div>

</section>

</div>

<div>

<section>

### **出力例 2**

<div>

0

</div>

<p>
$A$の空でない部分列として現れる 221 数列は存在しません。
</p>

</section>

</div>

---

<div>

<section>

### **入力例 3**

<div>

20
2 2 3 1 1 4 1 4 1 4 2 4 1 2 1 4 4 1 1 4

</div>

</section>

</div>

<div>

<section>

### **出力例 3**

<div>

15

</div>

</section>

</div>

</span>

</span>

</div>
