
<div>

<span>

<span>

<p>
配点 : $425$点
</p>

<div>

<section>

### **問題文**

<p>
高橋君はゲームをプレイしています。
</p>

<p>
ゲームは $1,2,\ldots,N$の番号がついた $N$個のステージからなり、現在はステージ $1$のみを遊ぶことができます。
</p>

<p>
各ステージ $i$( $1\leq i \leq N-1$)が遊べるとき、ステージ $i$では以下の $2$つのどちらかの行動を行えます。
</p>

<ul>

<li>
$A_i$秒掛けてステージ $i$をクリアする。ステージ $i+1$を遊べるようになる。
</li>

<li>
$B_i$秒掛けてステージ $i$をクリアする。ステージ $X_i$を遊べるようになる。
</li>

</ul>

<p>
各ステージをクリアするためにかかる時間以外は無視できるとき、ステージ $N$を遊べるようになるのは最短で何秒後ですか？
</p>

</section>

</div>

<div>

<section>

### **制約**

<ul>

<li>
$2 \leq N \leq 2\times 10^5$
</li>

<li>
$1 \leq A_i, B_i \leq 10^9$
</li>

<li>
$1 \leq X_i \leq N$
</li>

<li>
入力は全て整数
</li>

</ul>

</section>

</div>

---

<div>

<div>

<section>

### **入力**

<p>
入力は以下の形式で標準入力から与えられる。
</p>

<div>

$N$$A_1$$B_1$$X_1$$A_2$$B_2$$X_2$$\vdots$$A_{N-1}$$B_{N-1}$$X_{N-1}$
</div>

</section>

</div>

<div>

<section>

### **出力**

<p>
答えを出力せよ。  
</p>

</section>

</div>

</div>

---

<div>

<section>

### **入力例 1**

<div>

5
100 200 3
50 10 1
100 200 5
150 1 2

</div>

</section>

</div>

<div>

<section>

### **出力例 1**

<div>

350

</div>

<p>
次のように行動することで、$350$秒でステージ $5$を遊べるようになります。
</p>

<ul>

<li>
$100$秒掛けてステージ $1$をクリアし、ステージ $2$を遊べるようになる。
</li>

<li>
$50$秒掛けてステージ $2$をクリアし、ステージ $3$を遊べるようになる。
</li>

<li>
$200$秒掛けてステージ $3$をクリアし、ステージ $5$を遊べるようになる。
</li>

</ul>

</section>

</div>

---

<div>

<section>

### **入力例 2**

<div>

10
1000 10 9
1000 10 10
1000 10 2
1000 10 3
1000 10 4
1000 10 5
1000 10 6
1000 10 7
1000 10 8

</div>

</section>

</div>

<div>

<section>

### **出力例 2**

<div>

90

</div>

</section>

</div>

---

<div>

<section>

### **入力例 3**

<div>

6
1000000000 1000000000 1
1000000000 1000000000 1
1000000000 1000000000 1
1000000000 1000000000 1
1000000000 1000000000 1

</div>

</section>

</div>

<div>

<section>

### **出力例 3**

<div>

5000000000

</div>

</section>

</div>

</span>

</span>

</div>
