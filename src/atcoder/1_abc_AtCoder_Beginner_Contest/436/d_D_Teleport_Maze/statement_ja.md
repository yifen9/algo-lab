
<div>

<span>

<span>

<p>
配点 : $400$点
</p>

<div>

<section>

### **問題文**

<p>
$H$行 $W$列のマス目からなる迷路があります。
上から $i$行目、左から $j$列目のマスを $(i,j)$と表記します。
マス $(i,j)$がどのようなマスであるかは文字 $S_{i,j}$として与えられ、各文字の意味は以下の通りです。
</p>

<ul>

<li>
`.`: 空きマス
</li>

<li>
`#`: 障害物マス
</li>

<li>
英小文字（`a`- `z`）: ワープマス
</li>

</ul>

<p>
迷路内では、以下の二種類の行動を好きな順序で何回でも行うことができます。
</p>

<ul>

<li>
歩行：現在いるマスから上下左右の四方向のいずれかに $1$マス分進んだマスへ移動する。ただし、障害物マスへ移動することや、マス目の外に移動することはできない。
</li>

<li>
ワープ：ワープマスにいるとき、そのワープマスと同じ文字が書かれたワープマスのうちいずれか好きなマスへと移動する。
</li>

</ul>

<p>
マス $(1,1)$からマス $(H,W)$へ移動することが可能かどうか判定し、可能ならばそれに必要な最小の合計行動回数を求めてください。
</p>

</section>

</div>

<div>

<section>

### **制約**

<ul>

<li>
$1\leq H,W \leq 1000$
</li>

<li>
$H\times W \geq 2$
</li>

<li>
$H,W$は整数
</li>

<li>
$S_{i,j}$は `.`, `#`, または英小文字のいずれか
</li>

<li>
$S_{1,1}\neq$`#`
</li>

<li>
$S_{H,W}\neq$`#`
</li>

</ul>

</section>

</div>

---

<div>

<div>

<section>

### **入力**

<p>
入力は以下の形式で標準入力から与えられる。
</p>

<div>

$H$$W$$S_{1,1}S_{1,2}\dots S_{1,W}$$\vdots$$S_{H,1}S_{H,2}\dots S_{H,W}$
</div>

</section>

</div>

<div>

<section>

### **出力**

<p>
マス $(1,1)$からマス $(H,W)$へ移動することが可能ならばそれに必要な最小の合計行動回数を、不可能ならば `-1`を出力せよ。
</p>

</section>

</div>

</div>

---

<div>

<section>

### **入力例 1**

<div>

3 4
..a.
####
ba#b

</div>

</section>

</div>

<div>

<section>

### **出力例 1**

<div>

5

</div>

<p>
以下のように行動することで、マス $(1,1)$からマス $(3,4)$へ移動することができます。
</p>

<ol>

<li>
マス $(1,1)$からマス $(1,2)$へ歩行によって移動する。
</li>

<li>
マス $(1,2)$からマス $(1,3)$へ歩行によって移動する。
</li>

<li>
マス $(1,3)$からマス $(3,2)$へワープによって移動する。 
</li>

<li>
マス $(3,2)$からマス $(3,1)$へ歩行によって移動する。 
</li>

<li>
マス $(3,1)$からマス $(3,4)$へワープによって移動する。
</li>

</ol>

<p>
このときの合計行動回数は $5$回であり、これが最小です。
</p>

</section>

</div>

---

<div>

<section>

### **入力例 2**

<div>

3 4
..a.
####
b.#b

</div>

</section>

</div>

<div>

<section>

### **出力例 2**

<div>

-1

</div>

<p>
マス $(1,1)$からマス $(3,4)$へ移動することは不可能です。
</p>

</section>

</div>

---

<div>

<section>

### **入力例 3**

<div>

4 4
xxxx
xxxx
xxxx
xxxx

</div>

</section>

</div>

<div>

<section>

### **出力例 3**

<div>

1

</div>

</section>

</div>

---

<div>

<section>

### **入力例 4**

<div>

7 11
u..#y..#...
k..#.z.#.k.
iju#...#x..
###########
..x#.t.#..n
abc#y..#...
..z#..t#.y.

</div>

</section>

</div>

<div>

<section>

### **出力例 4**

<div>

12

</div>

</section>

</div>

</span>

</span>

</div>
