
<div>

<span>

<span>

<p>
配点 : $650$点
</p>

<div>

<section>

### **問題文**

<p>
頂点に $1$から $N$の番号がついた $N$頂点の根付き木があります。

頂点 $1$が根で、頂点 $i$$(2 \leq i \leq N)$の親は頂点 $p_i$です。$(p_i \lt i)$

また、数列 $A = (A_1, A_2, \dots, A_N)$があります。  
</p>

<p>
根付き木の 
<strong>
ハッシュ値
</strong>
を次の手順によって得られる値とします。
</p>

<ul>

<li>
$f(n)$$(1 \leq n \leq N)$を $n = N, N-1, \dots, 2, 1$の順に次の計算をすることで得られる値とする。
<ul>

<li>
頂点 $n$が葉の場合、$f(n) = A_n$とする。
</li>

<li>
頂点 $n$が葉でない場合、$n$の子からなる集合を $C(n)$として $\displaystyle f(n) = A_n + \prod_{c \in C(n)} f(c)$とする。  
</li>

</ul>

</li>

<li>
$f(1) \bmod{998244353}$を根付き木のハッシュ値とする。
</li>

</ul>

<p>
$Q$個のクエリを与えられる順に処理してください。

各クエリでは $v, x$が与えられるので、$A_v$の値を $x$に更新した後、根付き木のハッシュ値を求めてください。
</p>

</section>

</div>

<div>

<section>

### **制約**

<ul>

<li>
$2 \leq N \leq 2 \times 10^5$
</li>

<li>
$1 \leq Q \leq 2 \times 10^5$
</li>

<li>
$1 \leq p_i \lt i$
</li>

<li>
$0 \leq A_i \lt 998244353$
</li>

<li>
$1 \leq v \leq N$
</li>

<li>
$0 \leq x \lt 998244353$
</li>

<li>
入力される値は全て整数
</li>

</ul>

</section>

</div>

---

<div>

<div>

<section>

### **入力**

<p>
入力は以下の形式で標準入力から与えられる。ここで $\mathrm{query}_i$は  $i$番目のクエリを意味する。
</p>

<div>

$N$$Q$$p_2$$p_3$$\dots$$p_N$$A_1$$A_2$$\dots$$A_N$$\mathrm{query}_1$$\mathrm{query}_2$$\vdots$$\mathrm{query}_Q$
</div>

<p>
各クエリは次の形式で与えられる。
</p>

<div>

$v$$x$
</div>

</section>

</div>

<div>

<section>

### **出力**

<p>
$Q$行出力せよ。$i$行目には $i$番目のクエリの答えを出力せよ。
</p>

</section>

</div>

</div>

---

<div>

<section>

### **入力例 1**

<div>

3 2
1 1
3 5 1
3 4
2 1

</div>

</section>

</div>

<div>

<section>

### **出力例 1**

<div>

23
7

</div>

<p>
はじめ、$A = (3, 5, 1)$です。

$1$番目のクエリは次のように処理されます。
</p>

<ul>

<li>
$A_3$を $4$に更新する。$A = (3, 5, 4)$となる。
</li>

<li>
根付き木のハッシュ値は以下の手順により $23$となるので、これを出力する。
<ul>

<li>
頂点 $3$は子を持たない。よって $f(3) = 4$である。
</li>

<li>
頂点 $2$は子を持たない。よって $f(2) = 5$である。
</li>

<li>
頂点 $1$は頂点 $2, 3$を子に持つ。よって $f(1) = 3 + 5 \times 4 = 23$である。
</li>

<li>
$f(1) \bmod{998244353} = 23$を根付き木のハッシュ値とする。
</li>

</ul>

</li>

</ul>

<p>
$2$番目のクエリは次のように処理されます。
</p>

<ul>

<li>
$A_2$を $1$に更新する。$A = (3, 1, 4)$となる。
</li>

<li>
根付き木のハッシュ値は以下の手順により $7$となるので、これを出力する。
<ul>

<li>
頂点 $3$は子を持たない。よって $f(3) = 4$である。
</li>

<li>
頂点 $2$は子を持たない。よって $f(2) = 1$である。
</li>

<li>
頂点 $1$は頂点 $2, 3$を子に持つ。よって $f(1) = 3 + 1 \times 4 = 7$である。
</li>

<li>
$f(1) \bmod{998244353} = 7$を根付き木のハッシュ値とする。
</li>

</ul>

</li>

</ul>

</section>

</div>

---

<div>

<section>

### **入力例 2**

<div>

5 4
1 1 2 2
2 5 4 4 1
3 3
5 0
4 5
5 2

</div>

</section>

</div>

<div>

<section>

### **出力例 2**

<div>

29
17
17
47

</div>

</section>

</div>

---

<div>

<section>

### **入力例 3**

<div>

10 10
1 2 1 2 5 6 3 5 1
766294629 440423913 59187619 725560240 585990756 965580535 623321125 550925213 122410708 549392044
1 21524934
9 529970099
6 757265587
8 219853537
5 687675301
5 844033519
8 780395611
2 285523485
6 13801766
3 487663184

</div>

</section>

</div>

<div>

<section>

### **出力例 3**

<div>

876873846
952166813
626349486
341294449
466546009
331098453
469507939
414882732
86695436
199797684

</div>

</section>

</div>

</span>

</span>

</div>
