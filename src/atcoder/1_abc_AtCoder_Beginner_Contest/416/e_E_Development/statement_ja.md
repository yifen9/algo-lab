
<div>

<span>

<span>

<p>
配点 : $450$点
</p>

<div>

<section>

### **問題文**

<p>
AtCoder 国には $1$から $N$の番号がついた $N$個の街と、$M$本の道路、$K$個の空港があります。
</p>

<p>
$i$番目の道路は街 $A_i$と街 $B_i$を双方向に結び、移動に $C_i$時間かかります。

空港は街 $D_1,\ldots,D_K$にあり、空港がある街同士は $T$時間で移動できます。
</p>

<p>
$Q$個のクエリが与えられるので順に処理してください。クエリは次の $3$種類のいずれかです。
</p>

<ul>

<li>
`1 x y t`: 街 $x$と街 $y$を双方向に $t$時間で結ぶ道路が作られる。
</li>

<li>
`2 x`: 街 $x$に空港が作られる。
</li>

<li>
`3`: $f(x,y)$を、街 $x$から街 $y$へ道路と空港を使って到達可能なときその最短時間、到達不可能なとき $0$とする。$\sum_{x=1}^{N}\sum_{y=1}^{N}f(x,y)$を求める。
</li>

</ul>

</section>

</div>

<div>

<section>

### **制約**

<ul>

<li>
$1 \leq N \leq 500$
</li>

<li>
$0 \leq M \leq 10^5$
</li>

<li>
$1 \leq A_i < B_i \leq N$
</li>

<li>
$1 \leq C_i \leq 10^9$
</li>

<li>
$0 \leq K \leq N$
</li>

<li>
$1 \leq T \leq 10^9$
</li>

<li>
$1 \leq D_1 < \dots < D_K \leq N$
</li>

<li>
$1 \leq Q \leq 1000$
</li>

<li>
$1$種類目のクエリにおいて、$1\leq x < y \leq N$, $1 \leq t \leq 10^9$
</li>

<li>
$2$種類目のクエリにおいて、$1 \leq x \leq N$
</li>

<li>
入力は全て整数
</li>

</ul>

</section>

</div>

---

<div>

<div>

<section>

### **入力**

<p>
入力は以下の形式で標準入力から与えられる。
</p>

<div>

$N$$M$$A_1$$B_1$$C_1$$\vdots$$A_M$$B_M$$C_M$$K$$T$$D_1$$\dots$$D_K$$Q$$\mathrm{Query}_1$$\vdots$$\mathrm{Query}_Q$
</div>

<p>
$\mathrm{Query}_i$は $i$番目のクエリを表し、その形式と意味は問題文中に与えられた通りである。
</p>

</section>

</div>

<div>

<section>

### **出力**

<p>
$3$種類目のクエリの解を順に改行区切りで出力せよ。
</p>

</section>

</div>

</div>

---

<div>

<section>

### **入力例 1**

<div>

4 1
1 2 10
2 100
1 3
5
3
1 2 3 60
3
2 4
3

</div>

</section>

</div>

<div>

<section>

### **出力例 1**

<div>

440
280
900

</div>

<p>
AtCoder 国には $4$つの街があり、最初、街 $1$と街 $2$の間を $10$時間で移動できる道路と、街 $1$と街 $3$の間を $100$時間で移動できる空港があります。
</p>

<ul>

<li>
最初、$f(1,2)=f(2,1)=10, f(1,3)=f(3,1)=100,f(2,3)=f(3,2)=110$であり、その他は $0$なので、$\sum_{x=1}^{N}\sum_{y=1}^{N}f(x,y)=440$です。
</li>

<li>
新たに街 $2$と街 $3$を $60$時間で結ぶ道路が作られました。
</li>

<li>
$f(1,2)=f(2,1)=10, f(1,3)=f(3,1)=70,f(2,3)=f(3,2)=60$であり、その他は $0$なので、$\sum_{x=1}^{N}\sum_{y=1}^{N}f(x,y)=280$です。
</li>

<li>
新たに街 $4$に空港ができました。
</li>

<li>
$f(1,2)=f(2,1)=10, f(1,3)=f(3,1)=70,f(1,4)=f(4,1)=100,f(2,3)=f(3,2)=60,f(2,4)=f(4,2)=110,f(3,4)=f(4,3)=100$であり、その他は $0$なので、$\sum_{x=1}^{N}\sum_{y=1}^{N}f(x,y)=900$です。
</li>

</ul>

<p>
2つの街の間に複数の道路が作られることや、1つの街に複数の空港が作られることもあります。
</p>

</section>

</div>

</span>

</span>

</div>
