
<div>

<span>

<span>

<p>
配点 : $575$点
</p>

<div>

<section>

### **問題文**

<p>
`1`,`2`,`3`,`?`からなる $H$行 $W$列のグリッド $S$が与えられます。上から $i$行目、左から $j$列目の文字は $S_{i,j}$です。
</p>

<p>
$S$の各 `?`を `1`,`2`,`3`のいずれかに置き換えて得られるグリッドは `?`の個数を $q$として $3^q$通りありますが、そのうち以下の条件を満たすものはいくつありますか？ $998244353$で割った余りを出力してください。
</p>

<ul>

<li>
隣接する（辺を共有する）どの $2$つのマスにも異なる数字が書かれている。
</li>

</ul>

</section>

</div>

<div>

<section>

### **制約**

<ul>

<li>
$1\leq H,W$
</li>

<li>
$H\times W\leq 200$
</li>

<li>
$H,W$は整数
</li>

<li>
$S$は `1`,`2`,`3`,`?`からなる $H$行 $W$列のグリッド
</li>

</ul>

</section>

</div>

---

<div>

<div>

<section>

### **入力**

<p>
入力は以下の形式で標準入力から与えられる。
</p>

<div>

$H$$W$$S_{1,1}S_{1,2}\ldots S_{1,W}$$S_{2,1}S_{2,2}\ldots S_{2,W}$$\vdots$$S_{H,1}S_{H,2}\ldots S_{H,W}$
</div>

</section>

</div>

<div>

<section>

### **出力**

<p>
答えを出力せよ。
</p>

</section>

</div>

</div>

---

<div>

<section>

### **入力例 1**

<div>

2 2
1?
??

</div>

</section>

</div>

<div>

<section>

### **出力例 1**

<div>

6

</div>

<p>
$S$の各 `?`を `1`,`2`,`3`のいずれかに置き換えて得られるグリッドのうち、条件を満たすものは以下の $6$つです。
</p>

<div>

12  12  12  13  13  13
21  23  31  21  31  32

</div>

</section>

</div>

---

<div>

<section>

### **入力例 2**

<div>

2 3
123
3?1

</div>

</section>

</div>

<div>

<section>

### **出力例 2**

<div>

0

</div>

<p>
$S$の各 `?`を `1`,`2`,`3`のいずれかに置き換えて得られるグリッドはすべて条件を満たしません。
</p>

</section>

</div>

---

<div>

<section>

### **入力例 3**

<div>

8 8
3?1?????
???1????
??????2?
????????
????????
????13??
??13?1??
????????

</div>

</section>

</div>

<div>

<section>

### **出力例 3**

<div>

779135038

</div>

</section>

</div>

</span>

</span>

</div>
