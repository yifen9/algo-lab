
<div>

<span>

<span>

<p>
配点 : $575$点
</p>

<div>

<section>

### **問題文**

<blockquote>

<p>
本問題の設定は D 問題と類似しています。D 問題とは、最大化の対象および制約の一部が異なります。
</p>

</blockquote>

<p>
不思議なコーラショップがあります。
このショップは直接コーラを売ることはしませんが、コーラの空き瓶と新しい瓶入りコーラとの交換サービスを提供しています。
</p>

<p>
はじめ、高橋君は瓶入りコーラを $N$本持っており、これから以下のいずれかの行動を選んで取ることを好きな回数繰り返すことができます（$0$回でもよい）。
</p>

<ul>

<li>
持っている瓶入りコーラ $1$本を飲む。持っている瓶入りコーラの本数が $1$減り、空き瓶の本数が $1$増える。
（行動前に $1$本も瓶入りコーラを持っていない場合、この行動は取れない。）
</li>

<li>
$1$以上 $M$以下の整数 $i$を選ぶ。コーラショップに $A_i$本の空き瓶を渡し、引き換えに $B_i$本の瓶入りコーラをもらう。
（行動前に持っている空き瓶の本数が $A_i$未満であるような $i$は選ぶことができない。
選ぶことのできる $i$が存在しない場合、この行動は取れない。）
</li>

</ul>

<p>
高橋君はコーラが大好きです。うまく行動を取ったとき、最大で何本のコーラを飲むことができますか？
</p>

<p>
なお、高橋君は最初空き瓶を $1$本も持っていないものとします。
</p>

</section>

</div>

<div>

<section>

### **制約**

<ul>

<li>
$1\leq N \leq 10^{15}$
</li>

<li>
$1\leq M \leq 2\times 10^5$
</li>

<li>
$1\leq B_i < A_i \leq 300$
</li>

<li>
入力は全て整数
</li>

</ul>

</section>

</div>

---

<div>

<div>

<section>

### **入力**

<p>
入力は以下の形式で標準入力から与えられる。
</p>

<div>

$N$$M$$A_1$$B_1$$A_2$$B_2$$\vdots$$A_M$$B_M$
</div>

</section>

</div>

<div>

<section>

### **出力**

<p>
答えを整数として出力せよ。
</p>

</section>

</div>

</div>

---

<div>

<section>

### **入力例 1**

<div>

5 3
5 4
5 1
4 2

</div>

</section>

</div>

<div>

<section>

### **出力例 1**

<div>

11

</div>

<p>
以下のような行動を考えます。
</p>

<ul>

<li>
最初、高橋君は瓶入りコーラを $5$本持っている。
</li>

<li>
持っている瓶入りコーラ $1$本を飲むことを $5$回繰り返す。高橋君は空き瓶を $5$本持った状態になる。
</li>

<li>
$i=1$として交換を行い、$5$本の空き瓶と引き換えに $4$本の瓶入りコーラをもらう。高橋君は瓶入りコーラを $4$本持った状態になる。
</li>

<li>
持っている瓶入りコーラ $1$本を飲むことを $4$回繰り返す。高橋君は空き瓶を $4$本持った状態になる。
</li>

<li>
$i=3$として交換を行い、$4$本の空き瓶と引き換えに $2$本の瓶入りコーラをもらう。高橋君は瓶入りコーラを $2$本持った状態になる。
</li>

<li>
持っている瓶入りコーラ $1$本を飲むことを $2$回繰り返す。高橋君は空き瓶を $2$本持った状態になる。
</li>

</ul>

<p>
このとき、高橋君は合計で $5+4+2=11$本のコーラを飲むことができます。
高橋君がどのように行動を取っても $12$本以上のコーラを飲むことはできないため、答えは $11$です。
</p>

</section>

</div>

---

<div>

<section>

### **入力例 2**

<div>

3 3
5 1
4 2
5 1

</div>

</section>

</div>

<div>

<section>

### **出力例 2**

<div>

3

</div>

<p>
元々持っている瓶入りコーラを飲むことしかできません。
</p>

</section>

</div>

---

<div>

<section>

### **入力例 3**

<div>

925532735634776 8
91 40
273 265
286 153
155 126
92 83
291 228
216 90
234 9

</div>

</section>

</div>

<div>

<section>

### **出力例 3**

<div>

31583804603529464

</div>

</section>

</div>

</span>

</span>

</div>
