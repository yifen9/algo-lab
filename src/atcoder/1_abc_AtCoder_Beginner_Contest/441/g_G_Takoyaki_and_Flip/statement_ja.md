
<div>

<span>

<span>

<p>
配点 : $575$点
</p>

<div>

<section>

### **問題文**

<p>
$N$枚の皿が左から右に一直線状に並んでいます。
左から $i$番目 $(1\le i\le N)$の皿を皿 $i$と呼ぶことにします。
はじめ、どの皿も表を上にして置かれており、どの皿にもたこ焼きが置かれていません。
</p>

<p>
次の $3$種類のクエリを合計 $Q$回処理してください。
</p>

<ul>

<li>
タイプ $1$：整数 $L,R,X$が与えられる。$i=L,L+1,\ldots,R$に対して、皿 $i$が表を上にして置かれているなら、皿 $i$にたこ焼きを $X$個置く。
</li>

<li>
タイプ $2$：整数 $L,R$が与えられる。$i=L,L+1,\ldots,R$に対して、皿 $i$にたこ焼きが $1$個以上置かれていた場合、皿 $i$に置かれているたこ焼きをすべて食べる。皿 $i$をひっくり返す（皿が表を上にして置かれている場合裏を上にして置き、そうでない場合表を上にして置く）。
</li>

<li>
タイプ $3$：整数 $L,R$が与えられる。皿 $L,$皿 $L+1,\ldots,$皿 $R$にわたる、置かれているたこ焼きの個数の最大値を出力する。
</li>

</ul>

</section>

</div>

<div>

<section>

### **制約**

<ul>

<li>
$1\le N\le2\times10 ^ 5$
</li>

<li>
$1\le Q\le2\times10 ^ 5$
</li>

<li>
すべてのクエリにおいて、$1\le L\le R\le N$
</li>

<li>
タイプ $1$のクエリにおいて、$1\le X\le10 ^ 9$
</li>

<li>
タイプ $3$のクエリが存在する。
</li>

<li>
入力はすべて整数
</li>

</ul>

</section>

</div>

---

<div>

<div>

<section>

### **入力**

<p>
入力は以下の形式で標準入力から与えられる。
</p>

<div>

$N$$Q$$\mathrm{query} _ 1$$\mathrm{query} _ 2$$\vdots$$\mathrm{query} _ Q$
</div>

<p>
ここで、$\mathrm{query} _ i$は $i$番目 $(1\le i\le Q)$のクエリを表し、次のどちらかの形式で与えられる。
</p>

<div>

$t$$L$$R$$X$
</div>

<div>

$t$$L$$R$
</div>

<p>
これらは、$i$番目のクエリがタイプ $t$のクエリで、与えられる整数が $L,R,X$もしくは $L,R$であることを表す。
タイプ $1$のクエリは前者の形式で、それ以外のクエリは後者の形式で与えられる。
</p>

</section>

</div>

<div>

<section>

### **出力**

<p>
タイプ $3$のクエリの個数を $q$として、$q$行にわたって出力せよ。
$i$行目 $(1\le i\le q)$には、タイプ $3$のクエリのうち先頭から $i$番目のものに対する答えを出力せよ。
</p>

</section>

</div>

</div>

---

<div>

<section>

### **入力例 1**

<div>

6 6
1 3 5 4
3 2 3
1 1 6 2
2 3 4
3 1 6
3 2 3

</div>

</section>

</div>

<div>

<section>

### **出力例 1**

<div>

4
6
2

</div>

<p>
各クエリの時点で、それぞれの皿の状態とその上に置かれているたこ焼きの個数は以下の図のようになります。
</p>

<p>

<img src="https://img.atcoder.jp/abc441/5a1f8a0f9bdb43a16c4f458213f3b8e7.png">

</img>

</p>

<p>
$2$番目のクエリの時点では、皿 $2$と皿 $3$のうち置かれているたこ焼きの個数がより多いのは皿 $3$です。
よって、$1$行目には皿 $3$に置かれているたこ焼きの個数である `4`を出力してください。
</p>

<p>
$5$番目のクエリの時点では、皿 $1,$皿 $2,\ldots,$皿 $6$のうち置かれているたこ焼きの個数が最も多いのは皿 $5$です。
よって、$2$行目には皿 $5$に置かれているたこ焼きの個数である `6`を出力してください。
</p>

<p>
$6$番目のクエリの時点では、皿 $2$と皿 $3$のうち置かれているたこ焼きの個数がより多いのは皿 $2$です。
よって、$3$行目には皿 $2$に置かれているたこ焼きの個数である `2`を出力してください。
</p>

</section>

</div>

---

<div>

<section>

### **入力例 2**

<div>

2 8
1 1 2 1000000000
1 1 2 1000000000
2 2 2
1 1 2 1000000000
1 1 2 1000000000
1 1 2 1000000000
3 2 2
3 1 2

</div>

</section>

</div>

<div>

<section>

### **出力例 2**

<div>

0
5000000000

</div>

<p>
裏を上にして置かれている皿にはひとつもたこ焼きは置かれないことに注意してください。
</p>

<p>
また、答えが $2 ^ {32}$以上になる場合があることに注意してください。
</p>

</section>

</div>

---

<div>

<section>

### **入力例 3**

<div>

24 30
1 11 24 4326
1 4 16 1149
1 14 20 2331
1 12 14 8930
1 22 23 6989
3 15 20
3 10 19
1 3 12 7988
1 18 23 8450
3 9 19
3 13 15
2 8 15
2 9 14
1 11 17 4062
1 6 15 1721
3 7 13
1 11 20 8541
1 8 10 3748
1 1 17 3252
2 9 23
2 1 23
3 2 22
1 5 23 7468
3 1 12
3 12 19
2 6 24
3 2 14
3 1 15
2 15 19
3 2 14

</div>

</section>

</div>

<div>

<section>

### **出力例 3**

<div>

7806
16736
22393
16736
10858
0
7468
7468
0
0
0

</div>

</section>

</div>

</span>

</span>

</div>
