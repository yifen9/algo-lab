
<div>

<span>

<span>

<p>
Score : $600$points
</p>

<div>

<section>

### **Problem Statement**

<p>
We have a grid $A$with $N$rows and $M$columns. Initially, $0$is written on every square.

Let us perform the following operation.
</p>

<ul>

<li>
For each integer $i$such that $1 \le i \le N$, in the $i$-th row, turn the digits in zero or more leftmost squares into $1$.
</li>

<li>
For each integer $j$such that $1 \le j \le M$, in the $j$-th column, turn the digits in zero or more topmost squares into $1$.
</li>

</ul>

<p>
Let $S$be the set of grids that can be obtained in this way.
</p>

<p>
You are given a grid $X$with $N$rows and $M$columns consisting of `0`, `1`, and `?`.

There are $2^q$grids that can be obtained by replacing each `?`with `0`or `1`, where $q$is the number of `?`in $X$. How many of them are in $S$?

This count can be enormous, so find it modulo $998244353$.
</p>

</section>

</div>

<div>

<section>

### **Constraints**

<ul>

<li>
$N$and $M$are integers.
</li>

<li>
$1 \le N,M \le 18$
</li>

<li>
$X$is a grid with $N$rows and $M$columns consisting of `0`, `1`, and `?`.
</li>

</ul>

</section>

</div>

---

<div>

<div>

<section>

### **Input**

<p>
The input is given from Standard Input in the following format:
</p>

<div>

$N$$M$$X_{1,1} X_{1,2} \dots X_{1,M}$$X_{2,1} X_{2,2} \dots X_{2,M}$$\vdots$$X_{N,1} X_{N,2} \dots X_{N,M}$
</div>

</section>

</div>

<div>

<section>

### **Output**

<p>
Print an integer representing the answer.
</p>

</section>

</div>

</div>

---

<div>

<section>

### **Sample Input 1**

<div>

2 3
0?1
?1?

</div>

</section>

</div>

<div>

<section>

### **Sample Output 1**

<div>

6

</div>

<p>
The following six grids are in $S$.
</p>

<div>

011  011  001
010  011  110

001  011  011
111  110  111

</div>

</section>

</div>

---

<div>

<section>

### **Sample Input 2**

<div>

5 3
101
010
101
010
101

</div>

</section>

</div>

<div>

<section>

### **Sample Output 2**

<div>

0

</div>

<p>
$X$may have no `?`, and the answer may be $0$.
</p>

</section>

</div>

---

<div>

<section>

### **Sample Input 3**

<div>

18 18
??????????????????
??????????????????
??????????????????
??????????????????
??????????????????
??????????????????
??????????????????
??????????????????
??????????????????
??????????????????
??????????????????
??????????????????
??????????????????
??????????????????
??????????????????
??????????????????
??????????????????
??????????????????

</div>

</section>

</div>

<div>

<section>

### **Sample Output 3**

<div>

462237431

</div>

<p>
Be sure to find the count modulo $998244353$.
</p>

</section>

</div>

</span>

</span>

</div>
