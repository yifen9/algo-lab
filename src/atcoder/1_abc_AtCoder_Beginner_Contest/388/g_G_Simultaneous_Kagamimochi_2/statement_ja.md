
<div>

<span>

<span>

<p>
配点 : $575$点
</p>

<div>

<section>

### **問題文**

<p>
$N$個の餅が小さいほうから順に並んでいます。
$i$番目 $(1\leq i\leq N)$の餅の大きさは $A _ i$です。
</p>

<p>
$2$つの餅 $A,B$の大きさをそれぞれ $a,b$としたとき、$a$が $b$の半分以下であるとき、かつそのときに限り、餅 $A$を餅 $B$の上に乗せて鏡餅を $1$つ作ることができます。
</p>

<p>
整数の $2$つ組が $Q$個与えられます。
$i$番目 $(1\leq i\leq Q)$の $2$つ組を $(L _ i,R _ i)$として、次の問題をすべての $i$について解いてください。
</p>

<blockquote>

<p>
$L _ i$番目から $R _ i$番目までの $R _ i-L _ i+1$個の餅だけを使って、同時にいくつの鏡餅を作ることができるか求めてください。
</p>

<p>
より厳密には、以下ができるような最大の非負整数 $K$を求めてください。
</p>

<ul>

<li>
$L _ i$番目から $R _ i$番目までの $R _ i-L _ i+1$個の餅から $2K$個の餅を選んで $K$個の $2$つ組に分け、それぞれの組について一方をもう一方の上に乗せることで鏡餅を $K$個作る。
</li>

</ul>

</blockquote>

</section>

</div>

<div>

<section>

### **制約**

<ul>

<li>
$2\leq N\leq 2\times 10 ^ 5$
</li>

<li>
$1\leq A _ i\leq 10 ^ 9\ (1\leq i\leq N)$
</li>

<li>
$A _ i\leq A _ {i+1}\ (1\leq i\lt N)$
</li>

<li>
$1\leq Q\leq 2\times 10 ^ 5$
</li>

<li>
$1\leq L _ i\lt R _ i\leq N\ (1\leq i\leq Q)$
</li>

<li>
入力はすべて整数
</li>

</ul>

</section>

</div>

---

<div>

<div>

<section>

### **入力**

<p>
入力は以下の形式で標準入力から与えられる。
</p>

<div>

$N$$A _ 1$$A _ 2$$\dotsc$$A _ N$$Q$$L _ 1$$R _ 1$$L _ 2$$R _ 2$$\vdots$$L _ Q$$R _ Q$
</div>

</section>

</div>

<div>

<section>

### **出力**

<p>
$Q$行出力せよ。
$i$行目 $(1\leq i\leq Q)$には、$i$番目の $2$つ組に対応する問題の答えを出力せよ。
</p>

</section>

</div>

</div>

---

<div>

<section>

### **入力例 1**

<div>

11
1 1 2 3 4 4 7 10 11 12 20
5
2 5
3 8
7 11
1 2
1 11

</div>

</section>

</div>

<div>

<section>

### **出力例 1**

<div>

2
3
1
0
5

</div>

<p>
それぞれの問題に対する答えは以下のようになります。
鏡餅の作り方は一例です。
</p>

<ul>

<li>
それぞれの餅の大きさは $(1,2,3,4)$です。$(1,3),(2,4)$の $2$つの鏡餅を作ることができます。
</li>

<li>
それぞれの餅の大きさは $(2,3,4,4,7,10)$です。$(2,4),(3,7),(4,10)$の $3$つの鏡餅を作ることができます。
</li>

<li>
それぞれの餅の大きさは $(7,10,11,12,20)$です。$(10,20)$の $1$つの鏡餅を作ることができます。
</li>

<li>
それぞれの餅の大きさは $(1,1)$です。$1$つも鏡餅を作ることができません。
</li>

<li>
それぞれの餅の大きさは $(1,1,2,3,4,4,7,10,11,12,20)$です。$(1,2),(1,3),(4,10),(4,11),(7,20)$の $5$つの鏡餅を作ることができます。
</li>

</ul>

<p>
以上より、`2``3``1``0``5`をこの順に出力してください。
</p>

</section>

</div>

---

<div>

<section>

### **入力例 2**

<div>

24
127 148 170 174 258 311 331 414 416 436 517 523 532 587 591 638 660 748 760 776 837 857 972 984
15
7 11
8 9
8 13
12 15
9 23
1 17
8 12
1 5
6 17
3 7
12 19
13 18
7 22
1 12
14 15

</div>

</section>

</div>

<div>

<section>

### **出力例 2**

<div>

0
0
0
0
2
6
0
1
1
0
0
0
3
5
0

</div>

</section>

</div>

</span>

</span>

</div>
