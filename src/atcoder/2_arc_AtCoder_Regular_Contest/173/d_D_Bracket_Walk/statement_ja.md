
<div>

<span>

<span>

<p>
配点 : $700$点
</p>

<div>

<section>

### **問題文**

<p>
$N$頂点 $M$辺の有向グラフ $G$があります。頂点には $1$から $N$の番号が付いており、各辺には `(`, `)`のいずれかのラベルが付与されています。$i$番目の辺は頂点 $u_i$から頂点 $v_i$に向かう辺であり、ラベル $c_i$が付与されています。このグラフは多重辺、自己ループを持ちません。
</p>

<p>
このグラフにおいては任意の $2$頂点 $s,t$に対して、 $s$から $t$に向かうパスが存在します。
</p>

<p>
グラフ $G$上の
<b>
ウォーク
</b>
であって、以下の条件をすべて満たすものが存在するか判定してください。
</p>

<ul>

<li>
ウォークの始点と終点は同じ頂点である
</li>

<li>
$i=1,2,\dots,M$に対して、 $i$番目の辺はウォークに $1$回以上用いられる
</li>

<li>
ウォークに用いた辺のラベルを、辺の使用順に並べて得られる文字列は正しい括弧列である
</li>

</ul>

<details>

<summary>
ウォークとは
</summary>
グラフ $G$上のウォークとは、 $k$個（ $k$は正整数）の頂点と $k-1$個の辺を交互に並べた列 $(v_1,e_1,v_2,\dots,v_{k-1},e_{k-1},v_k)$であって、辺 $e_i$が頂点 $v_i$から頂点 $v_{i+1}$へ向かう辺であるようなものを指し、頂点 $v_1,v_k$をそれぞれウォークの始点、終点とよぶ。


</details>

<details>

<summary>
正しい括弧列とは 
</summary>

<p>
正しい括弧列とは、以下のいずれかの条件を満たす文字列です。


</p>

<ul>

<li>
空文字列 
</li>

<li>
ある正しい括弧列 $A$が存在して `(`, $A$, `)`をこの順に連結した文字列 
</li>

<li>
ある空でない正しい括弧列 $A,B$が存在して、 $A,B$をこの順に連結した文字列 
</li>

</ul>

<p>

</p>

</details>

</section>

</div>

<div>

<section>

### **制約**

<ul>

<li>
$2 \leq N \leq 4000$
</li>

<li>
$N \leq M \leq 8000$
</li>

<li>
$1 \leq u_i,v_i \leq N$
</li>

<li>
$c_i$は `(`, `)`のいずれか
</li>

<li>
$u_i \neq v_i$
</li>

<li>
$i \neq j$ならば $(u_i,v_i) \neq (u_j,v_j)$
</li>

<li>
入力される数値はすべて整数
</li>

<li>
入力で与えられるグラフにおいて、任意の $2$頂点 $s,t$に対して、 $s$から $t$に向かうパスが存在する。
</li>

</ul>

</section>

</div>

---

<div>

<div>

<section>

### **入力**

<p>
入力は以下の形式で標準入力から与えられる。
</p>

<div>

$N$$M$$u_1$$v_1$$c_1$$u_2$$v_2$$c_2$$\vdots$$u_M$$v_M$$c_M$
</div>

</section>

</div>

<div>

<section>

### **出力**

<p>
条件を満たすウォークが存在する場合は `Yes`を、存在しない場合は `No`を出力せよ。
</p>

</section>

</div>

</div>

---

<div>

<section>

### **入力例 1**

<div>

5 7
1 2 (
2 3 )
3 4 (
4 1 )
2 4 )
4 5 (
5 1 )

</div>

</section>

</div>

<div>

<section>

### **出力例 1**

<div>

Yes

</div>

<p>
辺 $1,2,3,4,1,5,6,7$をこの順で用いるウォークは、すべての辺を一度以上用いており、辺のラベルを使用順に並べて得られる文字列 `()()()()`は正しい括弧列であるため、条件を満たします。
</p>

<p>
ウォークは同じ辺を $2$回以上使用したり、同じ頂点を $2$回以上訪れるものであっても構いません。
</p>

</section>

</div>

---

<div>

<section>

### **入力例 2**

<div>

2 2
1 2 )
2 1 )

</div>

</section>

</div>

<div>

<section>

### **出力例 2**

<div>

No

</div>

</section>

</div>

---

<div>

<section>

### **入力例 3**

<div>

10 20
4 5 (
5 6 (
6 7 )
2 5 )
5 8 (
6 3 )
8 5 )
1 2 (
9 10 (
4 7 (
3 4 )
8 9 (
2 1 )
1 4 )
2 3 )
3 2 (
7 8 (
7 4 )
10 9 )
9 8 )

</div>

</section>

</div>

<div>

<section>

### **出力例 3**

<div>

Yes

</div>

</section>

</div>

</span>

</span>

</div>
