
<div>

<span>

<span>

<p>
配点 : $1000$点
</p>

<div>

<section>

### **問題文**

<p>
あなたは、以下の条件を満たすように、長さ $3$の数列を $N$個作ります。
</p>

<ul>

<li>
$k=1,2,3$の全てに対して、次の条件が成り立つ
<ul>

<li>
各数列の $k$項目を集めたとき、$1$から  $N$までの整数がちょうど $1$回ずつ現れる
</li>

</ul>

</li>

</ul>

<p>
この数列の列に対して、以下のように数列 $a=(a_1,a_2, \ldots ,a_N), b=(b_1,b_2,\ldots ,b_N)$を定義します。
</p>

<ul>

<li>
$i$番目の数列を $s_i$、$i$番目の数列を逆順にしたものを $t_i$とし、これらを全て辞書順に並べた時、$s_i$が $a_i$番目、$t_i$が $b_i$番目である
</li>

<li>
ただし、$2N$個の数列の中に同一の数列が $2$個以上存在する場合には、$a, b$は定義されない
</li>

</ul>

<p>
したがって、$a, b$が定義される場合には、$a$と $b$を合わせた数列には $1$から $2N$までの整数がちょうど $1$回ずつ現れます。
</p>

<p>
長さ $N$の数列 $A,B$が与えられます。ただし、$A$の各項は $1$以上 $2N$以下の整数であり、$B$の各項は $1$以上 $2N$以下の整数または $-1$です。
また、$A$と $B$を合わせた数列には $-1$以外の整数は $1$回以下しか現れません。
</p>

<p>
$a, b$が定義され、$1$以上 $N$以下のすべての整数 $i$に対して
</p>

<ul>

<li>
$a_i = A_i$
</li>

<li>
$B_i \neq -1$ならば $b_i = B_i$
</li>

</ul>

<p>
がともに成り立つとき、あり得る数列 $a,b$の組は何通りあるでしょうか。
答えを $998244353$で割った余りを求めてください。
</p>

</section>

</div>

<div>

<section>

### **制約**

<ul>

<li>
$2\leq N\leq 3000$
</li>

<li>
$1\leq A_i\leq 2N$
</li>

<li>
$1\leq B_i\leq 2N$または $B_i=-1$
</li>

<li>
$A$と $B$を合わせた数列には $-1$以外の整数は $1$回以下しか現れない。つまり、以下が成り立つ
<ul>

<li>
$i\neq j$のとき $A_i\neq A_j$
</li>

<li>
$i\neq j$かつ $B_i,B_j\neq -1$のとき $B_i\neq B_j$
</li>

<li>
$A_i\neq B_j$
</li>

</ul>

</li>

<li>
入力される値はすべて整数である
</li>

</ul>

</section>

</div>

---

<div>

<div>

<section>

### **入力**

<p>
入力は以下の形式で標準入力から与えられる。
</p>

<div>

$N$$A_1$$A_2$$\ldots$$A_N$$B_1$$B_2$$\ldots$$B_N$
</div>

</section>

</div>

<div>

<section>

### **出力**

<p>
答えを $998244353$で割った余りを整数で出力せよ。
</p>

</section>

</div>

</div>

---

<div>

<section>

### **入力例 1**

<div>

3
2 3 6
-1 1 -1

</div>

</section>

</div>

<div>

<section>

### **出力例 1**

<div>

1

</div>

<p>
例えば、$3$つの数列を以下のように作った場合を考えます。
</p>

<ol>

<li>
$(1,2,3)$
</li>

<li>
$(2,1,1)$
</li>

<li>
$(3,3,2)$
</li>

</ol>

<p>
このとき、$s_i$および $t_i$を辞書順に並べると、
</p>

<blockquote>

<p>
$t_2=(1,1,2)<s_1=(1,2,3)<s_2=(2,1,1)<t_3=(2,3,3)<t_1=(3,2,1)<s_3=(3,3,2)$
</p>

</blockquote>

<p>
となっているため、$(a_1,a_2,a_3,b_1,b_2,b_3)=(2,3,6,5,1,4)$です。このとき、$a$は与えられた $A$に一致し、$b$の第 $2$項も $B$と一致しており、これは題意を満たす数列 $a,b$の $1$つです。
</p>

<p>
また、$3$つの数列を以下のように作った場合は、$s_1=t_1$となってしまうため $a,b$が定義されません。 
</p>

<ol>

<li>
$(1,2,1)$
</li>

<li>
$(2,1,3)$
</li>

<li>
$(3,3,2)$
</li>

</ol>

<p>
実は、題意を満たす数列は $a=(2,3,6), b=(5,1,4)$のみです。
</p>

</section>

</div>

---

<div>

<section>

### **入力例 2**

<div>

15
5 16 1 12 30 20 4 13 9 8 24 21 26 28 17
-1 -1 6 -1 -1 -1 -1 -1 -1 -1 -1 29 -1 -1 -1

</div>

</section>

</div>

<div>

<section>

### **出力例 2**

<div>

758094847

</div>

<p>
答えを $998244353$で割った余りを出力してください。
</p>

</section>

</div>

</span>

</span>

</div>
