
<div>

<div>

### **問題文**

<section>
高橋君はある日、以下のようなゲームで遊ぶことにしました。

$m$色のブロックが $n$個、$1$つずつ順番に落ちてきます。

$1$つ落ちてくるたびに、高橋君は落ちてきたそのブロックを取って山に積むか、積まずに捨てるか選べます。

ブロックを積む山は $1$つで、ブロックは必ず山の一番上に積まないといけません。

全てのブロックが落ちきった後、出来た山は以下のように評価されます。

<ul>

<li>
色ボーナス：色ごとに決められた得点が、山に含まれている個数分与えられます。
</li>

<li>
コンボボーナス：同じ色のブロックが $x$個続いて積まれている場合、コンボボーナス配点 $Y$に応じて $Y×(x-1)$点が与えられます。
</li>

<li>
全色ボーナス：山の中に $m$色のブロックがそれぞれ $1$個以上含まれていると $Z$点が与えられます。
</li>

</ul>
落ちてくるブロックの種類と順番、またそれぞれ山を評価するための配点が与えられたとき、評価で得ることのできる最高得点を求めなさい。

</section>

</div>

---

<div>

<div>

### **入力**

<section>
入力は以下の形式で標準入力から与えられる。

<div>

$n$$m$$Y$$Z$$c_1$$p_1$$c_2$$p_2$$:$$:$$c_m$$p_m$$b_1b_2 ‥‥ b_n$
</div>

<ul>

<li>
$1$行目に $n, m, Y, Z$が半角スペースで区切られて与えられる。
		
<ol>

<li>
$n$はブロックの個数で $1≦n≦5,000$を満たす。
</li>

<li>
$m$はブロックの色の総数で $1≦m≦10$を満たす。
</li>

<li>
$Y$はコンボボーナス配点で $-100≦Y≦100$を満たす。
</li>

<li>
$Z$は全色ボーナス配点で $-10,000≦Z≦10,000$を満たす。
</li>

<li>
$n, m, Y, Z$は全て整数である。
</li>

</ol>

</li>

<li>
$2$行目からの $m+1$行目までの  $m$行で色ボーナスの配点がそれぞれ与えられる。
		
<ol>

<li>
$c_i$は $i(1≦i≦m)$番目に与えられるブロックの色である。
</li>

<li>
$p_i$は $c_i$に対する色ボーナスの配点である。
</li>

<li>
$c_i$は英大文字(`A`-`Z`)、$p_i$は $-100≦p_i≦100$を満たす。
</li>

<li>
配点は重複して与えられない（$x≠y$ならば $c_x≠c_y$)
</li>

</ol>

</li>

<li>
$m+2$行目には落ちてくるブロックの順序を表す長さ $n$の文字列が与えられる。
		
<ol>

<li>
$b_j$は $j(1≦j≦n)$番目に落ちてくるブロックの色を表している。
</li>

<li>
$b_j$は $c_1,c_2,...,c_m$のいずれかである。
</li>

</ol>

</li>

</ul>

</section>

</div>

</div>

<div>

### **出力**

<section>
評価で得ることのできる得点の最大値を標準出力に $1$行で出力せよ。

なお、最後には改行を出力せよ。

</section>

</div>

---

<div>

### **入力例 1**

<section>

<div>

5 3 3 5
R 1
G 1
B 1
RGBRR

</div>

</section>

</div>

<div>

### **出力例 1**

<section>

<div>

13

</div>

<ul>

<li>
全てのブロックを山に積むと、
		
<ul>

<li>
色ボーナス：どの色も配点が $1$点なので、$1$点 × $5$個 $= 5$点
</li>

<li>
コンボボ−ナス：Rが $2$個連続しているので、$3×(2-1)=3$点
</li>

<li>
全色ボーナス：全ての色が $1$つ以上山に積まれているので、$5$点
</li>

</ul>
により、$5+3+5=13$点が与えられます。
	
</li>

<li>
いずれかのブロックを捨てるとこの点数よりも低くなるので、答えは $13$点です。
</li>

</ul>

</section>

</div>

---

<div>

### **入力例 2**

<section>

<div>

3 3 3 5
R 1
G 3
B 2
RBR

</div>

</section>

</div>

<div>

### **出力例 2**

<section>

<div>

5

</div>

<ul>

<li>
全てのブロックを山に積むと、
		
<ul>

<li>
色ボーナス：$1$点 $×2$個 $+2$点 $×1$個 $=4$点
</li>

<li>
連続していないのでコンボボーナス、Gが含まれていないので全色ボーナスはそれぞれ $0$点
</li>

</ul>
により、$4$点です。
	
</li>

<li>
しかし、Bを捨ててRRを山に積むと、
		
<ul>

<li>
色ボーナス：$1$点 $×2$個 $=2$点
</li>

<li>
コンボボーナス：$3×(2-1)=3$点
</li>

</ul>
で、$5$点が最高得点です。
	
</li>

</ul>

</section>

</div>

---

<div>

### **入力例 3**

<section>

<div>

8 3 5 3
R 1
G 1
B 1
RRGRRBRR

</div>

</section>

</div>

<div>

### **出力例 3**

<section>

<div>

31

</div>

<ul>

<li>
図 $(a)$のように順に $8$個のブロックが落ちてきます。
</li>

<li>
ブロックを全部山に積むと、図 $(b)$のように、$2$個のコンボが $3$組できます。
</li>

<li>
また、全色ボーナスもつくので、$1$点 × $8$個 + $5$点 $× (2-1) × 3$組 $+ 3$点 $= 26$点です。
</li>

<li>
しかし、図 $(c)$のようにRのみを山に積むと、$1$点 × $6$個 + $5$点 $× (6-1) + 0$点 $= 31$点になります。
</li>

<li>
Rだけ山に積むとき最高得点となり、$31$が答えです。
</li>

</ul>

<img src="https://atcoder.jp/img/arc/010/3_1.png">

</img>

</section>

</div>

---

<div>

### **入力例 4**

<section>

<div>

8 3 5 3
R 1
G 100
B 1
RRGRRBRR

</div>

</section>

</div>

<div>

### **出力例 4**

<section>

<div>

126

</div>

<ul>

<li>
全部積んだ場合(図 $(a)$)：$107$点 + $5$点 $× (2-1) × 3$組 $+ 3$点 $= 125$点
</li>

<li>
Rのみを積んだ場合(図 $(b)$)：$6$点 + $5$点 $× (6-1) + 0$点 $= 31$点
</li>

<li>
B以外を積んだ場合(図 $(c)$)：$106$点 + $5$点 $× \{(2-1) + (4-1)\} + 0$点 $= 126$点
</li>

<li>
したがって、最高得点は $126$点です。

</li>

</ul>

<img src="https://atcoder.jp/img/arc/010/3_2.png">

</img>

</section>

</div>

</div>
