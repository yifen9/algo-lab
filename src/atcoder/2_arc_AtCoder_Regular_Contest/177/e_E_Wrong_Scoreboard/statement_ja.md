
<div>

<span>

<span>

<p>
配点 : $1000$点
</p>

<div>

<section>

### **問題文**

<p>
AtCoder World Tour Finals 2800 には $N$人の選手が参加し、全 $5$問の問題が出題されました。
各問題には $1$点以上の整数の配点が付けられており、配点が
<strong>
広義単調増加
</strong>
になるように、問 $1$から問 $5$までの問題番号が付けられています。
ここで部分点はありません。
また、通常の AtCoder のルールと同様、以下の方法で順位付けが行われます。
<strong>
なお、本問では合計得点もペナルティも同じという状況は考えないことにします。
</strong>

</p>

<details>

<summary>
順位付けの方法
</summary>
合計得点の高い方が上の順位となる。同点の場合は、ペナルティが $1$秒でも少ない方が上の順位となる。
</details>

<p>



</p>

<p>
さて、AtCoder World Tour Finals の取材を担当している青木記者は、以下の情報をメモしました。
</p>

<ol>

<li>
参加者数 $N$。
</li>

<li>
各選手がどの問題を解いたかの情報。$A_{i,j}=1$のとき $i$番目の選手 $(1 \leq i \leq N)$は問 $j$を正解し、$A_{i,j}=0$のとき正解しなかった。
</li>

<li>
各選手の順位。$i$番目の選手 $(1 \leq i \leq N)$は $R_i$位を獲得した。
</li>

</ol>

<p>
しかし、記事を書き始めようとしたとき、彼は配点およびペナルティの情報をメモしていないことに気付きました。
さらに、メモした情報に矛盾があるかもしれないことにも気付きました。
そこで以下の問題を解いてください。
</p>

<blockquote>

<p>
メモ 1 およびメモ 2 が正しいと仮定する。
選手 $i$$(1 \leq i \leq N)$の実際の順位を $D_i$とするとき、二乗誤差の合計 $(D_1 - R_1)^2 + (D_2 - R_2)^2 + \dots + (D_N - R_N)^2$として考えられる最小値を求めよ。
</p>

</blockquote>

<p>
$T$個のテストケースが与えられるので、それぞれについて答えを求めてください。
</p>

</section>

</div>

<div>

<section>

### **制約**

<ul>

<li>
$1 \leq T \leq 10^5$
</li>

<li>
$2 \leq N \leq 3 \times 10^5$
</li>

<li>
$A_{i,1}, A_{i,2}, A_{i,3}, A_{i,4}, A_{i,5}$は $0$または $1$$(1 \leq i \leq N)$
</li>

<li>
$A_{i,1}, A_{i,2}, A_{i,3}, A_{i,4}, A_{i,5}$の合計は $1$以上 $(1 \leq i \leq N)$
</li>

<li>
$1 \leq R_i \leq N$$(1 \leq i \leq N)$
</li>

<li>
$R_1, R_2, \dots, R_N$は相異なる
</li>

<li>

<span>
すべてのテストケースにおける $N$の値の合計は $3 \times 10^5$以下
</span>

</li>

<li>
入力はすべて整数
</li>

</ul>

</section>

</div>

---

<div>

<div>

<section>

### **入力**

<p>
入力は以下の形式で標準入力から与えられます。ここで $\mathrm{case}_i$は $i$番目 $(1 \leq i \leq T)$のテストケースを意味します。
</p>

<div>

$T$$\mathrm{case}_1$$\mathrm{case}_2$$\vdots$$\mathrm{case}_T$
</div>

<p>
各テストケースは、以下の形式で与えられます。
</p>

<div>

$N$$A_{1,1}$$A_{1,2}$$A_{1,3}$$A_{1,4}$$A_{1,5}$$A_{2,1}$$A_{2,2}$$A_{2,3}$$A_{2,4}$$A_{2,5}$$\vdots$$A_{N,1}$$A_{N,2}$$A_{N,3}$$A_{N,4}$$A_{N,5}$$R_1$$R_2$$\cdots$$R_N$
</div>

</section>

</div>

<div>

<section>

### **出力**

<p>
答えを出力してください。
</p>

</section>

</div>

</div>

---

<div>

<section>

### **入力例 1**

<div>

6
4
0 1 1 0 0
1 0 0 1 0
1 1 0 1 0
1 0 1 0 0
1 2 3 4
8
0 1 0 0 0
1 1 0 1 0
0 1 1 0 1
1 0 0 0 0
1 1 0 1 0
0 1 0 0 0
0 0 0 1 0
0 1 1 1 1
7 4 2 8 3 6 5 1
6
1 1 0 0 0
0 0 1 0 0
1 1 1 0 0
0 0 0 1 0
1 1 1 1 0
0 0 0 0 1
1 2 3 4 5 6
6
1 1 0 0 0
0 0 1 0 0
1 1 1 0 0
0 0 0 1 0
1 1 1 1 0
0 0 0 0 1
6 5 4 3 2 1
20
0 0 0 0 1
0 0 1 0 0
1 1 0 0 1
1 0 1 0 1
0 0 0 1 1
0 0 1 1 1
1 1 1 1 0
1 1 0 1 0
0 0 1 1 0
1 0 1 0 0
0 1 0 0 1
0 1 1 1 1
1 1 1 1 1
0 1 0 1 0
1 0 0 0 1
1 1 1 0 0
0 1 1 1 0
0 0 0 1 0
1 1 1 0 1
1 1 0 1 1
7 18 3 5 19 11 13 2 4 10 14 15 17 6 16 9 8 12 1 20
15
0 0 1 1 0
0 0 0 1 0
0 0 0 0 1
0 0 1 1 1
1 1 0 0 1
0 1 1 1 0
1 1 1 1 1
0 1 1 0 1
1 1 0 1 0
1 0 0 1 1
1 0 1 0 0
1 1 0 1 1
0 1 0 1 0
1 1 0 0 0
0 1 0 0 1
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15

</div>

</section>

</div>

<div>

<section>

### **出力例 1**

<div>

6
0
26
0
1054
428

</div>

<p>
この入力には全部で $6$個のテストケースがありますが、まずは $1$つ目のテストケースについて説明します。
</p>

<blockquote>

<p>
以下のような場合を考えます。
</p>

<ul>

<li>
$1, 2, 3, 4, 5$問目の配点がそれぞれ $100$点、$500$点、$800$点、$900$点、$1300$点である。
</li>

<li>
$1, 2, 3, 4$番目の参加者のペナルティがそれぞれ $90$分、$80$分、$70$分、$60$分である。
</li>

</ul>

<p>
このとき、順位表は下表のようになり、二乗誤差の合計は $(2-1)^2 + (3-2)^2 + (1-3)^2 + (4-4)^2 = 6$となります。二乗誤差の合計を $5$以下にする方法は存在しないため、$6$が答えとなります。
</p>

<p>

</p>

<div>

<div>

<table>

<thead>

<tr>

<th>
参加者
</th>

<th>
問 1
</th>

<th>
問 2
</th>

<th>
問 3
</th>

<th>
問 4
</th>

<th>
問 5
</th>

<th>
合計点
</th>

<th>
ペナルティ
</th>

<th>
順位
</th>

</tr>

</thead>

<tbody>

<tr>

<td>

<b>
1 番目
</b>

</td>

<td>
-
</td>

<td>
500
</td>

<td>
800
</td>

<td>
-
</td>

<td>
-
</td>

<td>
1300
</td>

<td>
90 分
</td>

<td>
2 位
</td>

</tr>

<tr>

<td>

<b>
2 番目
</b>

</td>

<td>
100
</td>

<td>
-
</td>

<td>
-
</td>

<td>
900
</td>

<td>
-
</td>

<td>
1000
</td>

<td>
80 分
</td>

<td>
3 位
</td>

</tr>

<tr>

<td>

<b>
3 番目
</b>

</td>

<td>
100
</td>

<td>
500
</td>

<td>
-
</td>

<td>
900
</td>

<td>
-
</td>

<td>
1500
</td>

<td>
70 分
</td>

<td>
1 位
</td>

</tr>

<tr>

<td>

<b>
4 番目
</b>

</td>

<td>
100
</td>

<td>
-
</td>

<td>
800
</td>

<td>
-
</td>

<td>
-
</td>

<td>
900
</td>

<td>
60 分
</td>

<td>
4 位
</td>

</tr>

</tbody>

</table>

</div>

</div>

<p>

</p>

</blockquote>

---

<p>
続いて、$2$つ目のテストケースについて説明します。
</p>

<blockquote>

<p>
以下のような場合を考えます。
</p>

<ul>

<li>
$1, 2, 3, 4, 5$問目の配点がそれぞれ $1000$点、$1400$点、$2000$点、$2000$点、$2718$点である。
</li>

<li>
$1, 2, \dots, 8$番目の参加者のペナルティがそれぞれ $295$分、$286$分、$242$分、$236$分、$277$分、$288$分、$187$分、$299$分である。
</li>

</ul>

<p>
このとき、順位表は下表のようになります。どの $i$$(1 \leq i \leq N)$についても $i$番目の参加者の順位が $R_i$となっているため、二乗誤差の合計は $0$となります。
</p>

<p>

</p>

<div>

<div>

<table>

<thead>

<tr>

<th>
参加者
</th>

<th>
問 1
</th>

<th>
問 2
</th>

<th>
問 3
</th>

<th>
問 4
</th>

<th>
問 5
</th>

<th>
合計点
</th>

<th>
ペナルティ
</th>

<th>
順位
</th>

</tr>

</thead>

<tbody>

<tr>

<td>

<b>
1 番目
</b>

</td>

<td>
-
</td>

<td>
1400
</td>

<td>
-
</td>

<td>
-
</td>

<td>
-
</td>

<td>
1400
</td>

<td>
295 分
</td>

<td>
7 位
</td>

</tr>

<tr>

<td>

<b>
2 番目
</b>

</td>

<td>
1000
</td>

<td>
1400
</td>

<td>
-
</td>

<td>
2000
</td>

<td>
-
</td>

<td>
4400
</td>

<td>
286 分
</td>

<td>
4 位
</td>

</tr>

<tr>

<td>

<b>
3 番目
</b>

</td>

<td>
-
</td>

<td>
1400
</td>

<td>
2000
</td>

<td>
-
</td>

<td>
2718
</td>

<td>
6118
</td>

<td>
242 分
</td>

<td>
2 位
</td>

</tr>

<tr>

<td>

<b>
4 番目
</b>

</td>

<td>
1000
</td>

<td>
-
</td>

<td>
-
</td>

<td>
-
</td>

<td>
-
</td>

<td>
1000
</td>

<td>
236 分
</td>

<td>
8 位
</td>

</tr>

<tr>

<td>

<b>
5 番目
</b>

</td>

<td>
1000
</td>

<td>
1400
</td>

<td>
-
</td>

<td>
2000
</td>

<td>
-
</td>

<td>
4400
</td>

<td>
277 分
</td>

<td>
3 位
</td>

</tr>

<tr>

<td>

<b>
6 番目
</b>

</td>

<td>
-
</td>

<td>
1400
</td>

<td>
-
</td>

<td>
-
</td>

<td>
-
</td>

<td>
1400
</td>

<td>
288 分
</td>

<td>
6 位
</td>

</tr>

<tr>

<td>

<b>
7 番目
</b>

</td>

<td>
-
</td>

<td>
-
</td>

<td>
-
</td>

<td>
2000
</td>

<td>
-
</td>

<td>
2000
</td>

<td>
187 分
</td>

<td>
5 位
</td>

</tr>

<tr>

<td>

<b>
8 番目
</b>

</td>

<td>
-
</td>

<td>
1400
</td>

<td>
2000
</td>

<td>
2000
</td>

<td>
2718
</td>

<td>
8118
</td>

<td>
299 分
</td>

<td>
1 位
</td>

</tr>

</tbody>

</table>

</div>

</div>

<p>

</p>

</blockquote>

<p>



</p>

</section>

</div>

</span>

</span>

</div>
