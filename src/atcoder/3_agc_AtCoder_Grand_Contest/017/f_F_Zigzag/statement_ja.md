
<div>

<span>

<span>

<p>
配点 : $1600$点
</p>

<div>

<section>

### **問題文**

<p>
下図のように，$1$辺が $N$個の点からなる正三角形状に，$N(N+1)/2$個の点が並んでいます．
上から $i$段目の左から $j$番目の点を $(i, j)$で表すことにします($1 \leq i \leq N$, $1 \leq j \leq i$)．
また，$(i+1, j)$を $(i, j)$のすぐ左下の点，$(i+1, j+1)$を $(i, j)$のすぐ右下の点と呼ぶことにします．
</p>

<p>

<img src="https://atcoder.jp/img/agc017/8d354fb1a389a0aa5b64ba93f6ca7801.png">

</img>

</p>

<p>
高橋君は，この点を結んで，$M$個の折れ線 $1, 2, ..., M$を描くことにしました．
各折れ線は，$(1, 1)$から始めて，「現在いる点のすぐ左下の点かすぐ右下の点を選び，現在いる点と選んだ点を直線で結んだのち，選んだ点へ移動する」
ことを $N-1$回繰り返すことで得られます．
すなわち，ある $X_{i,1}, ..., X_{i,N}$が存在して，次が成り立ちます：
</p>

<ul>

<li>
折れ線 $i$は，$N$個の点 $(1, X_{i,1}), (2, X_{i,2}), ..., (N, X_{i,N})$をこの順で結んでいる．
</li>

<li>
$j=1, 2, ..., N-1$に対して，$X_{i,j+1} = X_{i,j}$または $X_{i,j+1} = X_{i,j}+1$が成り立つ．
</li>

</ul>

<p>
高橋君は，折れ線 $i+1$が折れ線 $i$の左に来ることはないように折れ線を描きたいです．
つまり，$j=1, 2, ..., N$に対して，$X_{1,j} \leq X_{2,j} \leq ... \leq X_{M,j}$が成り立ちます．
</p>

<p>
また，高橋君は，折れ線の曲がり方について $K$個の条件を満たすように折れ線を描かなければなりません．
$i$番目の条件は $(A_i, B_i, C_i)$で表され，これは次を意味します：
</p>

<ul>

<li>
$C_i=0$のときは，折れ線 $A_i$を描くとき，$B_i$回目の移動においては，その時いる点のすぐ左下の点を選ぶ．
</li>

<li>
$C_i=1$のときは，折れ線 $A_i$を描くとき，$B_i$回目の移動においては，その時いる点のすぐ右下の点を選ぶ．
</li>

</ul>

<p>
すなわち，$X_{A_i, {B_i}+1} = X_{A_i, B_i} + C_i$を意味します．
</p>

<p>
高橋君が $M$個の折れ線を描く方法が何通りあるかを mod $1000000007$で求めてください．
</p>

</section>

</div>

<div>

<section>

### **注意**

<p>
提出を行う前に，「コードテスト」を利用して実行時間を計測することを強く推奨する．
</p>

</section>

</div>

<div>

<section>

### **制約**

<ul>

<li>
$1 \leq N \leq 20$
</li>

<li>
$1 \leq M \leq 20$
</li>

<li>
$0 \leq K \leq (N-1)M$
</li>

<li>
$1 \leq A_i \leq M$
</li>

<li>
$1 \leq B_i \leq N-1$
</li>

<li>
$C_i = 0,1$
</li>

<li>
$(A_i, B_i)$として同じ組は複数回与えられない．
</li>

</ul>

</section>

</div>

---

<div>

<div>

<section>

### **入力**

<p>
入力は以下の形式で標準入力から与えられる。
</p>

<div>

$N$$M$$K$$A_1$$B_1$$C_1$$A_2$$B_2$$C_2$:
$A_K$$B_K$$C_K$
</div>

</section>

</div>

<div>

<section>

### **出力**

<p>
高橋君が $M$個の折れ線を描く方法は何通りあるかを mod $1000000007$で出力せよ．
</p>

</section>

</div>

</div>

---

<div>

<section>

### **入力例 1**

<div>

3 2 1
1 2 0

</div>

</section>

</div>

<div>

<section>

### **出力例 1**

<div>

6

</div>

<p>
下図に示すように，$6$通りの描き方があります．ただし，赤線は折れ線 $1$，緑線は折れ線 $2$を表します：
</p>

<p>

<img src="https://atcoder.jp/img/agc017/75921b6e5a59ab17b4c07ada848b9f14.png">

</img>

</p>

</section>

</div>

---

<div>

<section>

### **入力例 2**

<div>

3 2 2
1 1 1
2 1 0

</div>

</section>

</div>

<div>

<section>

### **出力例 2**

<div>

0

</div>

</section>

</div>

---

<div>

<section>

### **入力例 3**

<div>

5 4 2
1 3 1
4 2 0

</div>

</section>

</div>

<div>

<section>

### **出力例 3**

<div>

172

</div>

</section>

</div>

---

<div>

<section>

### **入力例 4**

<div>

20 20 0

</div>

</section>

</div>

<div>

<section>

### **出力例 4**

<div>

881396682

</div>

</section>

</div>

</span>

</span>

</div>
