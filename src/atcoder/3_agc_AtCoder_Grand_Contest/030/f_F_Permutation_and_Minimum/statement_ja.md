
<div>

<span>

<span>

<p>
配点 : $1600$点
</p>

<div>

<section>

### **問題文**

<p>
長さ $2N$の数列 $A_1, A_2, ..., A_{2N}$があります．
各 $A_i$は $-1$か，あるいは $1$以上 $2N$以下の整数です．
$-1$以外のどの整数も，${A_i}$の中には $1$回までしか現れません．
</p>

<p>
すぬけ君は，$A_i = -1$であるような $i$それぞれに対して，$A_i$を $1$以上 $2N$の整数で置き換えて，${A_i}$が $1, 2, ..., 2N$の並び替えになるようにします．
そして，長さ $N$の数列 $B_1, B_2, ..., B_N$を，$B_i = min(A_{2i-1}, A_{2i})$として求めます．
</p>

<p>
数列 $B_1, B_2, ..., B_N$として考えられる異なるものの個数を $10^9 + 7$で割ったあまりを求めてください．
</p>

</section>

</div>

<div>

<section>

### **制約**

<ul>

<li>
$1 \leq N \leq 300$
</li>

<li>
$A_i = -1$あるいは $1 \leq A_i \leq 2N$
</li>

<li>
$A_i \neq -1, A_j \neq -1$ならば $A_i \neq A_j$($i \neq j$)
</li>

</ul>

</section>

</div>

---

<div>

<div>

<section>

### **入力**

<p>
入力は以下の形式で標準入力から与えられる．
</p>

<div>

$N$$A_1$$A_2$$...$$A_{2N}$
</div>

</section>

</div>

<div>

<section>

### **出力**

<p>
数列 $B_1, B_2, ..., B_N$として考えられる異なるものの個数を $10^9 + 7$で割ったあまりを出力せよ．
</p>

</section>

</div>

</div>

---

<div>

<section>

### **入力例 1**

<div>

3
1 -1 -1 3 6 -1

</div>

</section>

</div>

<div>

<section>

### **出力例 1**

<div>

5

</div>

<p>
${A_i}$を $1, 2, ..., 2N$の並び替えにする方法は $6$通りありますが，そのそれぞれに対して ${B_i}$は次のようになります：
</p>

<ul>

<li>
$(A_1, A_2, A_3, A_4, A_5, A_6) = (1, 2, 4, 3, 6, 5)$: $(B_1, B_2, B_3) = (1, 3, 5)$
</li>

<li>
$(A_1, A_2, A_3, A_4, A_5, A_6) = (1, 2, 5, 3, 6, 4)$: $(B_1, B_2, B_3) = (1, 3, 4)$
</li>

<li>
$(A_1, A_2, A_3, A_4, A_5, A_6) = (1, 4, 2, 3, 6, 5)$: $(B_1, B_2, B_3) = (1, 2, 5)$
</li>

<li>
$(A_1, A_2, A_3, A_4, A_5, A_6) = (1, 4, 5, 3, 6, 2)$: $(B_1, B_2, B_3) = (1, 3, 2)$
</li>

<li>
$(A_1, A_2, A_3, A_4, A_5, A_6) = (1, 5, 2, 3, 6, 4)$: $(B_1, B_2, B_3) = (1, 2, 4)$
</li>

<li>
$(A_1, A_2, A_3, A_4, A_5, A_6) = (1, 5, 4, 3, 6, 2)$: $(B_1, B_2, B_3) = (1, 3, 2)$
</li>

</ul>

<p>
よって，異なる $B_1, B_2, B_3$は $5$個あります．
</p>

</section>

</div>

---

<div>

<section>

### **入力例 2**

<div>

4
7 1 8 3 5 2 6 4

</div>

</section>

</div>

<div>

<section>

### **出力例 2**

<div>

1

</div>

</section>

</div>

---

<div>

<section>

### **入力例 3**

<div>

10
7 -1 -1 -1 -1 -1 -1 6 14 12 13 -1 15 -1 -1 -1 -1 20 -1 -1

</div>

</section>

</div>

<div>

<section>

### **出力例 3**

<div>

9540576

</div>

</section>

</div>

---

<div>

<section>

### **入力例 4**

<div>

20
-1 -1 -1 -1 -1 -1 -1 -1 -1 -1 6 -1 -1 -1 -1 -1 7 -1 -1 -1 -1 -1 -1 -1 -1 -1 34 -1 -1 -1 -1 31 -1 -1 -1 -1 -1 -1 -1 -1

</div>

</section>

</div>

<div>

<section>

### **出力例 4**

<div>

374984201

</div>

</section>

</div>

</span>

</span>

</div>
