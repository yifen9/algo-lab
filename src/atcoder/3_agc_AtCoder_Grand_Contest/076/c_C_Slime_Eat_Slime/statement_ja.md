
<div>

<span>

<span>

<p>
配点 : $1200$点
</p>

<div>

<section>

### **問題文**

<p>
$1$から $N$までの番号のついた $N$匹のスライムがいます．
それぞれのスライムの色は $0$以上 $2K$以下の整数で表され，スライム $i$の色は $C_i$です．
</p>

<p>
今，$M$組のスライムが（双方向の）友達関係にあり，具体的にはスライム $A_i$とスライム $B_i$は友達です ($1 \leq i \leq M$)．
ここで，どの $2$匹のスライムについても，友達関係をたどることで一方から他方へ到達できることが保証されます．
</p>

<p>
あなたは以下の操作を行うことができます．
</p>

<ul>

<li>
まず，次の条件を両方とも満たすスライムの組 $(u,v)$を選ぶ．
<ul>

<li>
スライム $u,v$は友達関係にある．
</li>

<li>
$(C_u - C_v) \bmod (2K+1) \geq K+1$（なお，$x \bmod y$の結果は常に $[0,y-1]$の範囲に入るとする）
</li>

</ul>

</li>

<li>
そして，スライム $u$にスライム $v$を食べさせる．
ここでスライム $v$は場から消える．
また，スライム $v$と友達関係にあった $u$以外のすべてのスライムは，スライム $u$と友達になる（すでにスライム $u$と友達であった場合は何も起きない）．
</li>

</ul>

<p>
適切に操作を繰り返すことでスライム $1$だけを場に残すことが可能かどうか判定してください．
</p>

<p>
$1$つの入力につき，$T$ケースを解いてください．
</p>

</section>

</div>

<div>

<section>

### **制約**

<ul>

<li>
$1 \leq T \leq 125000$
</li>

<li>
$2 \leq N \leq 250000$
</li>

<li>
$N-1 \leq M \leq 250000$
</li>

<li>
$1 \leq K \leq N$
</li>

<li>
$0 \leq C_i \leq 2K$
</li>

<li>
$1 \leq A_i < B_i \leq N$
</li>

<li>
$(A_i,B_i) \neq (A_j,B_j)$($i \neq j$)
</li>

<li>
どの $2$匹のスライムについても，友達関係をたどることで一方から他方へ到達できる
</li>

<li>
$T$ケースにわたる $N$の総和は $250000$以下
</li>

<li>
$T$ケースにわたる $M$の総和は $250000$以下
</li>

<li>
入力はすべて整数
</li>

</ul>

</section>

</div>

---

<div>

<div>

<section>

### **入力**

<p>
入力は以下の形式で標準入力から与えられる．
</p>

<div>

$T$$case_1$$case_2$$\vdots$$case_T$
</div>

<p>
各テストケースは以下の形式で与えられる．
</p>

<div>

$N$$M$$K$$C_1$$C_2$$\cdots$$C_N$$A_1$$B_1$$A_2$$B_2$$\vdots$$A_M$$B_M$
</div>

</section>

</div>

<div>

<section>

### **出力**

<p>
$T$行出力せよ．
$i$行目には，$i$ケース目においてスライム $1$だけを場に残すことが可能ならば `Yes`，不可能ならば `No`を出力せよ．
</p>

</section>

</div>

</div>

---

<div>

<section>

### **入力例 1**

<div>

4
2 1 1
0 0
1 2
3 2 1
0 2 1
1 2
2 3
6 6 1
0 0 1 2 1 0
1 2
2 3
3 4
4 5
5 6
1 6
5 4 2
2 4 3 2 1
1 2
2 4
2 5
3 5

</div>

</section>

</div>

<div>

<section>

### **出力例 1**

<div>

No
Yes
No
No

</div>

<p>
$1$つ目のテストケースでは，操作を $1$回も行うことができません．
</p>

<p>
$2$つ目のテストケースでは，以下の手順でスライム $1$だけを場に残すことができます．
</p>

<ul>

<li>
$(u,v)=(3,2)$と選び，スライム $3$にスライム $2$を食べさせる．スライム $2$が消え，スライム $1$とスライム $3$が友達になる．
</li>

<li>
$(u,v)=(1,3)$と選び，スライム $1$にスライム $3$を食べさせる．スライム $3$が消える．
</li>

</ul>

</section>

</div>

</span>

</span>

</div>
