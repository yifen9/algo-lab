
<div>

<span>

<span>

<div>

<section>

### **問題文**

<p>
$N\times N$マスのコンテナターミナルがある。
一番左上のマスの座標を $(0,0)$とし、そこから下方向に $i$マス、右方向に $j$マス進んだ先のマスの座標を $(i,j)$とする。
$0$から $N^2-1$の番号が振られた $N^2$個のコンテナが運び込まれてくるので、$N$台のクレーンを操作することで、指定された順番で搬出してほしい。
</p>

<p>
マップの左端と右端には、それぞれ以下のような搬入口・搬出口が存在する。
</p>

<ul>

<li>
搬入口: 左端の各マスは搬入口であり、各搬入口からはコンテナがそれぞれ $N$個ずつ順番に運び込まれてくる。事前にどの番号のコンテナが運び込まれて来るかが分かっており、$(i,0)$にある搬入口から $j$番目に運び込まれるコンテナの番号は $A_{i,j}$である。
</li>

<li>
搬出口: 右端の各マスは搬出口であり、各搬出口に置かれたコンテナは即座に外部へ運び出される。$(i,N-1)$にある搬出口からは、$N\times i,N\times i+1,\cdots,N\times i+N-1$番のコンテナをこの順番で搬出したい。
</li>

</ul>

<p>
搬入口、搬出口を含む各マスには高々 $1$つのコンテナを配置することが出来る。
搬出口以外に置かれたコンテナは搬出されないため、順番を調整するための一時置き場として利用出来る。
</p>

<p>
クレーンは $1$台の大クレーンと、$N-1$台の小クレーンの $2$種類が存在する。初期状態で大クレーンは $(0,0)$のマスに、小クレーンは $(1,0), (2,0), \cdots, (N-1,0)$の各マスに $1$台ずつ配置されている。
</p>

<p>
各クレーンはコンテナを掴む、離す、隣接マスに移動する、といった操作が可能である。
コンテナが置かれていないマスには常にクレーンを移動可能であり、コンテナを掴んでいない場合はコンテナが置かれているマスにも移動出来る。
一方で、コンテナを掴んでいる状態でコンテナが置かれているマスに移動出来るかどうかは、クレーンの種類によって異なる。
</p>

<p>
大クレーンはコンテナを高く持ち上げて運ぶため、コンテナを掴んでいる状態でも他のコンテナが置かれているマスに移動することが出来る。
小クレーンの場合はコンテナを持ち上げる高さが低いため、コンテナを掴んでいる状態では他のコンテナが置かれているマスに移動することが出来ない。
</p>

<p>
毎ターン、各クレーンごとに独立に以下の操作から $1$つを選んで実行することが出来る。
</p>

<ul>

<li>
`P`: 現在位置に存在するコンテナを掴む。すでにコンテナを掴んでいる場合や、現在位置にコンテナが存在しない場合は 
<span>
WA
</span>
となる。
</li>

<li>
`Q`: 掴んでいるコンテナを離し、現在位置に配置する。コンテナを掴んでいない場合や、現在位置に既にコンテナが存在する場合は 
<span>
WA
</span>
となる。
</li>

<li>
`U`, `D`, `L`, `R`: 上下左右に隣接するマスへ移動する。小クレーンかつコンテナを掴んでいる状態の場合は、移動先のマスにコンテナが存在してはならない。$N\times N$マスの外へ移動するような操作を行うことは出来ない。
</li>

<li>
`.`: 何もせずにその場に留まる。
</li>

<li>
`B`: クレーンを爆破する。コンテナを掴んでいる状態では爆破することは出来ない。爆破したクレーンは盤面から排除され、以後 `.`以外の操作をすることは出来ない。
</li>

</ul>

<p>
禁止されている操作を行った場合、
<span>
WA
</span>
となる。
</p>

<p>
それぞれのクレーンはコンテナを掴んでいるかどうかに関わらず、重なったり、すれ違うことは出来ない。
すなわち、同じマスに複数のクレーンが存在してはならず、$2$つのクレーンがお互いの位置を交換するように移動することは出来ない。
</p>

<p>
各クレーンの操作は同時に行われるため、マス $p$に存在するクレーンがマス $q$に移動するのと同じターンに、マス $q$に存在するクレーンをマス $r$($r\neq p$) に移動させたり爆破したりするような操作が可能である。ただし、$r=p$の場合はすれ違う移動となるため不可能である。
</p>

<p>
各ターンは以下の $3$ステップからなる。
</p>

<ol>

<li>
運び込まれてくるコンテナがまだ残っている各搬入口について、そのマスにコンテナ及びコンテナを掴んだ状態のクレーンが存在しない場合、次の順番のコンテナがそのマスに配置される。
</li>

<li>
各クレーンの操作を行う。
</li>

<li>
各搬出口について、そのマスにコンテナが配置されている場合、そのコンテナを搬出して盤面から取り除く。
</li>

</ol>

<p>
操作は最大で $10000$ターン繰り返すことが出来る。
短いターン数で指定された順番に近い順にコンテナを搬出出来るような操作列を求めてほしい。
</p>

</section>

</div>

<div>

<section>

### **得点**

<p>
以下のように $M_0, M_1, M_2, M_3$の値を定める。
</p>

<ul>

<li>
$M_0$: 出力した操作列のターン数。
</li>

<li>
$M_1$: 正しい搬出口から搬出したコンテナの転倒数の総和。すなわち、$(i,N-1)$の搬出口から搬出されたコンテナのうち、番号 $b$が $N\times i\leq b<N\times (i+1)$を満たすようなものを、搬出した順に $B_{i,0},\cdots,B_{i,n_i-1}$としたとき、$0\leq j < k < n_i$、$B_{i,j}>B_{i,k}$を満たすような組 $(i,j,k)$の総数が $M_1$である。
</li>

<li>
$M_2$: 間違った搬出口から搬出したコンテナの総数。すなわち、各搬出口 $(i,N-1)$から搬出されたコンテナのうち、番号 $b$が $N\times i \leq b < N\times (i+1)$を満たさないものの数を数え、その総和が $M_2$である。
</li>

<li>
$M_3$: 搬出されなかったコンテナの総数。
</li>

</ul>

<p>
このとき、以下の絶対スコアが得られる。

<font color="red">
<strong>
絶対スコアは小さければ小さいほど良い。
</strong>
</font>

</p>

<p>
\[
M_0+10^2M_1+10^4M_2+10^6M_3
\]
</p>

<p>
各テストケース毎に、$\mathrm{round}(10^9\times \frac{全参加者中の最小絶対スコア}{自身の絶対スコア})$の
<font color="red">
<strong>
相対評価スコア
</strong>
</font>
が得られ、その和が提出の得点となる。
</p>

<p>
最終順位はコンテスト終了後に実施されるより多くの入力に対するシステムテストにおける得点で決定される。
暫定テスト、システムテストともに、一部のテストケースで不正な出力や制限時間超過をした場合、そのテストケースの相対評価スコアは0点となり、そのテストケースにおいては「全参加者中の最小絶対スコア」の計算から除外される。
システムテストは
<font color="red">
<strong>

<span>
CE
</span>
以外の結
果を得た一番最後の提出
</strong>
</font>
に対してのみ行われるため、最終的に提出する解答を間違えないよう注意せよ。
</p>

#### **テストケース数**

<ul>

<li>
暫定テスト: 50個
</li>

<li>
システムテスト: 2000個、コンテスト終了後に <a href="https://img.atcoder.jp/ahc033/seeds.txt">seeds.txt</a>(sha256=502228d18e6d0d00f92654ad85f13945fc1d2865f69df352aee061a53ebf3cfa) を公開
</li>

</ul>

#### **相対評価システムについて**

<p>
暫定テスト、システムテストともに、
<span>
CE
</span>
以外の結果を得た一番最後の提出のみが順位表に反映される。
相対評価スコアの計算に用いられる各テストケース毎の全参加者中の最小絶対スコアの算出においても、順位表に反映されている最終提出のみが用いられる。
</p>

<p>
順位表に表示されているスコアは相対評価スコアであり、新規提出があるたびに、相対評価スコアが再計算される。
一方、提出一覧から確認出来る各提出のスコアは各テストケース毎の絶対スコアをそのまま足し合わせたものであり、相対評価スコアは表示されない。
最新以外の提出の、現在の順位表における相対評価スコアを知るためには、再提出が必要である。
不正な出力や制限時間超過をした場合、提出一覧から確認出来るスコアは0となるが、順位表には正解したテストケースに対する相対スコアの和が表示されている。
</p>

#### **実行時間について**

<p>
実行時間には多少のブレが生じます。
また、システムテストでは同時に大量の実行を行うため、暫定テストに比べて数%程度実行時間が伸びる現象が確認されています。
そのため、実行時間制限ギリギリの提出がシステムテストで
<span>
TLE
</span>
となる可能性がありま
す。
プログラム内で時間を計測して処理を打ち切るか、実行時間に余裕を持たせるようお願いします。
</p>

</section>

</div>

---

<div>

<div>

<section>

### **入力**

<p>
入力は以下の形式で標準入力から与えられる。
</p>

<div>

$N$$A_{0,0}$$\cdots$$A_{0,N-1}$$\vdots$$A_{N-1,0}$$\cdots$$A_{N-1,N-1}$
</div>

<ul>

<li>
全てのテストケースで $N = 5$で固定である。
</li>

<li>
$A_{i,j}$は $(i,0)$の搬入口から $j$番目に搬入されるコンテナの番号であり、$0\leq A_{i,j}\leq N^2-1$を満たす整数値である。全ての $A_{i,j}$の値は異なる。
</li>

</ul>

</section>

</div>

<div>

<section>

### **出力**

<p>
以下の形式で標準出力に出力せよ。
</p>

<div>

$S_0$$\vdots$$S_{N-1}$
</div>

<p>
各 $S_i$は `P`、`Q`、`U`、`D`、`L`、`R`、`.`、`B`のみからなる文字列であり、その $t$文字目は初期位置 $(i,0)$のクレーンに対する $t$ターン目の操作を表す。
出力した各文字列の長さは $1$以上 $10000$以下でなければならない。
各文字列の長さは異なってもよく、その場合は最も長い文字列に合わせて文字列の末尾に `.`が追加される。
</p>

<p>
<a href="https://img.atcoder.jp/ahc033/ELSlXTEw.html?lang=ja&seed=0&output=sample">例を見る</a>
</p>

</section>

</div>

<div>

<section>

### **入力生成方法**

<p>
搬入順 $A_{i,j}$は、$0,1,\cdots,N^2-1$をランダムな順番にシャッフルし、$N$個ずつに区切ることにより生成される。
</p>

</section>

</div>

<div>

<section>

### **ツール(入力ジェネレータ・ビジュアライザ)**

<ul>

<li>
<a href="https://img.atcoder.jp/ahc033/ELSlXTEw.html?lang=ja">Web版</a>: ローカル版より高性能でアニメーション表示が可能です。
</li>

<li>
<a href="https://img.atcoder.jp/ahc033/ELSlXTEw.zip">ローカル版</a>: 使用するには<a href="https://www.rust-lang.org/ja">Rust言語</a>のコンパイル環境をご用意下さい。
<ul>

<li>
<a href="https://img.atcoder.jp/ahc033/ELSlXTEw_windows.zip">Windows用のコンパイル済みバイナリ</a>: Rust言語の環境構築が面倒な方は代わりにこちらをご利用下さい。
</li>

</ul>

</li>

</ul>

<p>
コンテスト期間中に、ビジュアライズ結果の共有や、解法・考察に関する言及は禁止されています。ご注意下さい。
</p>

</section>

</div>

</div>

---

<div>

<section>

### **入力例 1**

<div>

5
24 10 17 15 13
14 11 2 1 5
7 9 6 21 20
8 4 19 3 16
18 23 22 0 12

</div>

</section>

</div>

<div>

<section>

### **出力例 1**

<div>

PRDDDDRRRQLLLUUPRRRUQ
B
PRQB
PRRRRUUQB
PRRRRQB

</div>

</section>

</div>

</span>

</span>

</div>
